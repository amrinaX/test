LIBRARY ieee;
USE ieee.std_logic_1164.all;
USE ieee.std_logic_unsigned.all;
------------------------------------------------
ENTITY alu IS
	PORT(a,b:IN STD_LOGIC_VECTOR(3 DOWNTO 0);
		 sel:IN STD_LOGIC_VECTOR(3 DOWNTO 0);
		 cin:IN STD_LOGIC;
		 cout:OUT STD_LOGIC;
		 y_real:OUT STD_LOGIC_VECTOR(3 DOWNTO 0));
END alu;
-------------------------------------------------
ARCHITECTURE flow OF alu IS
	SIGNAL arith,logic:STD_LOGIC_VECTOR(4 DOWNTO 0);
	 SIGNAL y: STD_LOGIC_VECTOR (4 DOWNTO 0);
BEGIN
-------Arithmetic unit----------------------------
	WITH sel(2 DOWNTO 0)SELECT
		arith<= ('0' & a) WHEN "000",
				('0' & a)+1 WHEN "001",
				('0' & a)-1 WHEN "010",
				('0' & b)   WHEN "011",
			('0' & b)+1 WHEN "100",
			('0' & b)-1	WHEN "101",
			('0' & a)+('0' & b) WHEN "110",
			('0' & a)+('0' & b)+cin WHEN OTHERS;
---------Logic unit--------------------------------
WITH sel(2 DOWNTO 0) SELECT
	logic<= NOT		('0' & a) WHEN "000",
			NOT		('0' & b) WHEN "001",
			('0' & a) AND	('0' & b) WHEN "010",
			('0' & a) OR 	('0' & b) WHEN "011",
			('0' & a) NAND	('0' & b) WHEN "100",
			('0' & a) NOR	('0' & b) WHEN "101",
			('0' & a) XOR	('0' & b) WHEN "110",
			NOT(('0' & a) XOR ('0' & b)) WHEN OTHERS;
----------Mux------------------------------------
WITH sel(3) SELECT
		y<=arith WHEN '0',
			logic WHEN OTHERS;

WITH sel(3) SELECT
		cout<=y(4) WHEN '0',
			'0' WHEN OTHERS;
y_real<=y(3 DOWNTO 0);
END flow;

